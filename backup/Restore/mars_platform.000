//-------------------------------------------------------------------------------------------------
//  -- 版权所有者   : 中国大恒（集团）有限公司北京图像视觉技术分公司, 2010 -2015.
//  -- 保密级别     ：绝密.
//  -- 部门         : 硬件部，FPGA工作组
//  -- 模块名       : mars_platform
//  -- 设计者       : 邢海涛
//-------------------------------------------------------------------------------------------------
//
//  -- 版本记录 :
//
//  -- 作者         :| 版本号	:| 修改日期				:|  修改说明
//-------------------------------------------------------------------------------------------------
//  -- 邢海涛       :| V1.0		:| 2018/12/05 15:01:27	:|  初始版本
//-------------------------------------------------------------------------------------------------
//
//  -- 模块描述     :
//              1)  :
//
//              2)  :
//
//              3)  :
//
//-------------------------------------------------------------------------------------------------
//`include			"mars_platform_def.v"
//仿真单位/精度
`timescale 1ns/1ps
//-------------------------------------------------------------------------------------------------

module mars_platform # (
	//	-------------------------------------------------------------------------------------
	//	sensor 相关参数
	//	-------------------------------------------------------------------------------------
	parameter		SENSOR_SERIES									= "PYTHON"					,	//sensor系列，PYTHON  SONYIMX CMV
	parameter		SENSOR_MODEL									= "PYTHON25K"				,	//sensor系列中的具体型号
	//	-------------------------------------------------------------------------------------
	//	DDR memory 相关参数
	//	-------------------------------------------------------------------------------------
	parameter		MEM_DQ_WD										= 32						,	//DDR3 数据宽度
	parameter		MEM_ADDR_WD										= 14						,	//DDR3 地址宽度
	parameter		MEM_BANKADDR_WD									= 3							,	//DDR3 bank地址宽度
	parameter		MEM_SIZE_MBIT									= 2048						,	//DDR3 存储容量，以MBIT为单位，支持 512、1024、2048、4096
	parameter		MEM_DM_WD										= MEM_DQ_WD/8				,	//DDR3 数据屏蔽信号宽度
	parameter		MEM_DQS_WD										= MEM_DQ_WD/8				,	//DDR3 数据选通信号宽度
	parameter		FRAME_DEPTH_MAX									= 2							,	//最大的帧存深度，最小是1帧。可设置为 1 2 3 4 5 6 ......
	//	-------------------------------------------------------------------------------------
	//	interface 相关参数
	//	-------------------------------------------------------------------------------------
	parameter		INTERFACE_SERIES								= "10GIGE"					,	//interface系列，1GIGE 5GIGE 10GIGE USB3.0 CXP
	parameter		ETH_PKT_LENGTH_MAX								= 8192						,	//以太网包长最大值，以byte为单位，最小是8192，最大是65532
	//	-------------------------------------------------------------------------------------
	//	相机功能 相关参数
	//	-------------------------------------------------------------------------------------
	parameter		MROI_NUM_MAX 									= 1							,	//Multi-ROI的最大个数，如果不支持，则写1
	parameter		SIMULATION										= "FALSE"						//仿真模式，复位时间变短，加速仿真
	)
	(
	//	-------------------------------------------------------------------------------------
	//	晶振输入
	//	-------------------------------------------------------------------------------------
	input															clk_osc						,	//板上晶振时钟
	//	-------------------------------------------------------------------------------------
	//	sensor相关
	//	-------------------------------------------------------------------------------------
	input															i_clk_p						,  	//sensor输出的差分串行时钟正极，最大支持到600MHz
	input															i_clk_n						,	//sensor输出的差分串行时钟负极，最大支持到600MHz
	input	[CHANNEL_NUM-1:0]										iv_data_p					, 	//sensor输出的差分串行数据正极，最大支持到1200Mb/s，图像数据
	input	[CHANNEL_NUM-1:0]										iv_data_n					, 	//sensor输出的差分串行数据负极，最大支持到1200Mb/s，图像数据
	input															i_ctrl_p					,	//sensor输出的差分串行数据正极，最大支持到1200Mb/s，控制数据
	input															i_ctrl_n					,	//sensor输出的差分串行数据负极，最大支持到1200Mb/s，控制数据
	output															o_clk_sensor_diff_p			,	//python sensor驱动差分时钟正极，360MHz
	output															o_clk_sensor_diff_n			,	//python sensor驱动差分时钟负极，360MHz
	output	[2:0]													ov_trigger_sensor			,	//sensor 触发输出
	input	[1:0]													iv_monitor					,	//sensor 状态输入
	output															o_reset_sensor_n			,	//clk_sensor 时钟域，Sensor的复位信号，低有效，1ms宽度，FPGA配置完成后立即输出。相机运行中不复位Sensor
	//	-------------------------------------------------------------------------------------
	//	IO接口信号
	//	-------------------------------------------------------------------------------------
	input															i_optocoupler				,	//输入引脚，光耦驱动，宽度从0到无穷大都有可能，上下沿有毛刺，宽度大于帧周期时需要屏蔽下降沿的误触发，异步信号
	input	[1:0]													iv_gpio						,	//输入引脚，三极管驱动，双向IO的输入端，宽度从0到无穷大都有可能，较容易受干扰，异步信号。双向IO配置为输入时需屏蔽为0
	output															o_optocoupler				,	//输出引脚，连接到光耦，光耦输出电路有延时，上沿延时7~44us，下沿延时9~35us
	output	[1:0]													ov_gpio						,	//输出引脚，连接到三极管，双向IO的输出端，延时<1us,双向IO配置为输入时需配置为0
	output															o_f_led_gre					,	//输出引脚，连接到LED，绿色指示灯，高电平点亮
	output															o_f_led_red					,	//输出引脚，连接到LED，红色指示灯，高电平点亮
	//  -------------------------------------------------------------------------------------
	//  DDR3 芯片接口
	//  -------------------------------------------------------------------------------------
	inout	[MEM_DQ_WD-1:0]											ddr3_dq						,  	//DDR3 数据信号
	output	[MEM_ADDR_WD-1:0]										ddr3_addr					,	//DDR3 地址信号
	output	[MEM_BANKADDR_WD-1:0]									ddr3_ba						,	//DDR3 bank 地址信号
	output                  										ddr3_ras_n					,	//DDR3 行选通信号，低有效
	output                  										ddr3_cas_n					,	//DDR3 列选通信号，低有效
	output                  										ddr3_we_n					,	//DDR3 写使能信号，低有效
	output                  										ddr3_odt					,	//DDR3 阻抗匹配信号，高有效
	output                  										ddr3_reset_n				,	//DDR3 复位信号，低有效
	output                  										ddr3_cke					,	//DDR3 时钟使能信号，高有效
	output  [MEM_DM_WD-1:0]											ddr3_dm						,	//DDR3 数据屏蔽信号，高有效，以byte为单位
	inout   [MEM_DQS_WD-1:0]										ddr3_dqs_p					,	//DDR3 数据选通信号正，以byte为单位
	inout   [MEM_DQS_WD-1:0]										ddr3_dqs_n					,	//DDR3 数据选通信号负，以byte为单位
	output                  										ddr3_ck_p					,	//DDR3 时钟信号正
	output															ddr3_ck_n					,	//DDR3 时钟信号负
	//  -------------------------------------------------------------------------------------
	//  10G PHY 接口
	//  -------------------------------------------------------------------------------------
	input  	            											refclk_p					,   // Refclk P - to differential GT clock buffer
	input  	            											refclk_n					,   // Refclk N - to differential GT clock buffer
	output 	            											rxaui_tx_l0_p				,   // GT0 TXP
	output 	            											rxaui_tx_l0_n				,   // GT0 TXN
	output 	            											rxaui_tx_l1_p				,   // GT1 TXP
	output 	            											rxaui_tx_l1_n				,   // GT1 TXN
	input  	            											rxaui_rx_l0_p				,   // GT0 RXP
	input  	            											rxaui_rx_l0_n				,   // GT0 RXN
	input  	            											rxaui_rx_l1_p				,   // GT1 RXP
	input  	            											rxaui_rx_l1_n				,   // GT1 RXN
	output															mdc							,
	inout															mdio						,
	inout 															iic_scl_io					,
	inout 															iic_sda_io					,
	inout 															spi_io0_io					,
	inout 															spi_io1_io					,
	inout [0:0]														spi_ss_io
	);


	//	ref paramters

	//	-------------------------------------------------------------------------------------
	//	sensor 相关参数
	//	-------------------------------------------------------------------------------------
	localparam			DIFF_TERM									= "TRUE"					;	//Differential Termination
	localparam			END_STYLE									= "LITTLE"					;	//"LITTLE" or "BIG" , "LITTLE" - {CHANNEL3 CHANNE2 CHANNEL1 CHANNEL0}. "BIG" - {CHANNEL0 CHANNEL1 CHANNEL2 CHANNEL3}.
	localparam			SAMPL_CLOCK_ARC								= "BUFIO"					;	//"BUFIO" or "BUFG" , deserializer clock achitecture
	localparam			INTER_CLOCK_ARC								= "BUFR"					;	//"BUFR" or "BUFG" , internal clock achitecture
	localparam			PIXEL_CLOCK_ARC								= "BUFG"					;	//"BUFR" or "BUFR" , pixel clock achitecture
	localparam			HIGH_PERFORMANCE_MODE 						= "FALSE"					;	//是否开启 HIGH_PERFORMANCE_MODE 模式
	localparam			REF_FREQ									= 200.0						;	//参考时钟频率
	localparam			MMCM_CHECK_CLK_PERIOD_NS					= 25						;	//MMCM检测时钟的周期

	localparam			SER_FIRST_BIT								= (SENSOR_SERIES=="PYTHON") ? "MSB" : "LSB"	;	//"LSB" or "MSB" , first bit to the receiver
	localparam			BIT_RATE_VALUE								= (SENSOR_MODEL=="PYTHON25K" && INTERFACE_SERIES=="10GIGE") ? 16 : 8	;	//差分通道个数
	localparam			DESER_WIDTH									= (SENSOR_SERIES=="PYTHON") ? 5 : 6	;	//每个通道解串宽度 4-8
	localparam real		CLKIN_PERIOD_NS								= (SENSOR_SERIES=="PYTHON") ? 2.778 : 3.333	;	//输入时钟频率，nS为单位
	localparam			KERNEL_LENTH								= (SENSOR_MODEL=="PYTHON25K") 64 : 16	;	//sensor的kernel的长度

	localparam			INCK_PER_US									= (SENSOR_SERIES=="PYTHON") ? 72 : 180		;	//1us的时钟数量，配置范围：大于等于21
	localparam			T2M_TIMEOUT_US								= 500						;	//trigger to monitor，输出trigger到sensor后等待monitor的最小超时时间，时间单位us。
	//																									不改变行消隐情况下python系列最大行周期为20us，曝光前可设置最大16行dummy_line，
	//																									理论最小超时时间为(16+1)*20=340us，目前暂取500us作为从触发到曝光的超时时间
	localparam			GIGE_ENABLE									= (INTERFACE_SERIES=="10GIGE" || INTERFACE_SERIES=="5GIGE" || INTERFACE_SERIES=="1GIGE") ? "TRUE" : "FALSE"	;	//模块是否用于GIGE。"TRUE"-模块用于GIGE项目；"FALSE"-模块不用于GIGE项目

	//	-------------------------------------------------------------------------------------
	//	DDR memory 相关参数
	//	-------------------------------------------------------------------------------------
	localparam			FRAME_DEPTH_ACTUAL							= 2**log2(FRAME_DEPTH_MAX)	;	//存储器实际上的帧存深度，因为帧存深度实际上是按照 2**N 划分的
	localparam			IMAGE_SIZE_MAX								= (MEM_SIZE_MBIT*1024*1024/(8*FRAME_DEPTH_ACTUAL) - INFO_SIZE*MROI_NUM_MAX - STATIS_SIZE)/(1024*1024)	;	//最大的图像尺寸，以byte为单位
	localparam			IMAGE_SIZE_WD								= log2(IMAGE_SIZE_MAX*1024*1024+1)	;	//图像数据大小位宽，以字节为单位
	localparam			FRAME_BUF_DATA_WD							= MEM_DQ_WD*8						;	//帧存处理数据位宽，MIG_7S 配置为慢速时钟，此时数据位宽是DQ位宽的8倍，时钟是外部时钟的1/4

	//	-------------------------------------------------------------------------------------
	//	interface 相关参数
	//	-------------------------------------------------------------------------------------
	localparam		BID_WD											= 16						;	//BID的位宽，gev1.2 位宽是16，gev2.0 位宽是64
	localparam		PID_WD											= 24						;	//PID的位宽，gev1.2 位宽是24，gev2.0 位宽是32
	localparam		PKT_LENGTH_WD									= 14						;	//packet length 包长寄存器宽度
	localparam		PKT_CNT_WD										= 18						;	//一帧图像中包含的完整包个数的位宽
	localparam		GEV_DATA_WD										= 64						;	//数据位宽，支持32、64、128
	localparam		GEV_DE_WD										= GEV_DATA_WD/32			;	//与frame_buffer接口的数据位宽也即gvsp_tx中传输的数据位宽
	localparam		GEV_BE_WD										= GEV_DATA_WD/8				;	//字节使能位宽，1byte数据使用一个使能位
	localparam		PB_RD_CNT_WD									= log2(ETH_PKT_LENGTH_MAX+1);	//packet buffer read cnt位宽，= log2(packet buffer depth)
	parameter		MAC_DATA_WD										= (INTERFACE_SERIES=="10GIGE") ? 64 : 32	;	//与mac接口的数据位宽，10GIGE时为64bit，其他速率时暂定32bit
	parameter		MAC_BE_WD										= MAC_DATA_WD/8				;	//MAC_DATA_WD字节使能标志位位宽
	//	-------------------------------------------------------------------------------------
	//	相机功能 相关参数
	//	-------------------------------------------------------------------------------------
	//	-------------------------------------------------------------------------------------
	//	--(1) ctrl_channel 相关
	//	-------------------------------------------------------------------------------------
	localparam		SHORT_REG_WD									= 16						;	//短寄存器位宽
	localparam		REG_WD											= 32						;	//长寄存器位宽
	localparam		LONG_REG_WD  						 			= 64						;	//长寄存器位宽
	localparam		LED_CTRL_WIDTH									= 5							;	//LED CTRL 寄存器宽度

	localparam		AXI_DATA_WD										= 32						;	//AXI总线数据位宽
	localparam		AXI_ADDR_WD										= 32						;	//AXI总线地址位宽

	localparam		MROI_OFFSET_WD									= SHORT_REG_WD*MROI_NUM_MAX	;	//Multi-ROI模式下所有roi偏移位宽之和，每个宽高offset的位宽固定为SHORT_REG_WD
	localparam		MROI_IMAGE_SIZE_WD								= REG_WD*MROI_NUM_MAX		;	//Multi-ROI模式下所有roi image size位宽之和，每个 image_size payload_size 的位宽固定为REG_WD

	//	-------------------------------------------------------------------------------------
	//	--(2) frame_info 相关
	//	-------------------------------------------------------------------------------------
	localparam		INFO_SIZE										= 256						;	//INFO段数据量，以byte为单位
	localparam		STATIS_SIZE										= 256						;	//STATIS段数据量，以byte为单位
	localparam		STATIS_VALID									= "FALSE"					;	//TRUE-statis段中的数据需要计算，FALSE-statis段中的数据填充为0
	localparam		INFO_WAIT_TIME									= 16						;	//从i_fval上升沿到info_flag之间的距离，以clk为单位
	localparam		IMAGE_WAIT_TIME									= 16						;	//从info_flag到image_flag之间的距离，以clk为单位
	localparam		STATIS_WAIT_TIME								= 16						;	//从i_fval下降沿到statis_flag之间的距离，以clk为单位
	localparam		FVAL_FALL_WAIT_TIME								= 16						;	//从statis_flag到i_fval下降沿之间的距离，以clk为单位
	localparam		BID_INIT_VALUE									= (GIGE_ENABLE=="TRUE") ? 1 : 0;	//开流之后，BID第一个是多少，U3是0，gige是1

	//	-------------------------------------------------------------------------------------
	//	--(3) data_channel 位宽相关
	//	-------------------------------------------------------------------------------------
	localparam		SENSOR_DAT_WIDTH								= DESER_WIDTH*2				;	//像素数据宽度
	localparam		PIX_CLK_FREQ_KHZ								= (SENSOR_SERIES=="PYTHON") ? 72000 : 60000		;	//本地像素时钟的频率，单位KHz
	localparam		U3V_FVAL_TO_DVAL_TIME							= 95						;	//从fval发出到稳定接收时间戳的时间


	//	ref functions

	//	-------------------------------------------------------------------------------------
	//	取对数，上取整
	//	log2取对数的时候，有两种情况。分别是计算计数器的位宽和计算通道偏移的bit数
	//	1.计算计数器的位宽，使用 y = log2(x+1)，当x=2^n时，y=n+1，可以表示0-2^(n+1)-1的数值
	//	2.计算通道偏移的bit数，使用 y = log2(x)，当x=2^n时，y=n，可以表示0-2^n-1的数值
	//	-------------------------------------------------------------------------------------
	function integer log2 (input integer xx);
		integer x;
		begin
			x	= xx-1 ;
			for (log2=0;x>0;log2=log2+1) begin
				x	= x >> 1;
			end
		end
	endfunction



	//	ref signals

	//	-------------------------------------------------------------------------------------
	//	clock_reset
	//	-------------------------------------------------------------------------------------
	wire															w_rxaui_locked				;	//rxaui输出，未知时钟域，rxaui锁定信号，高有效
	wire															w_reset_sensor				;	//ctrl_channel输出，clk_osc_bufg时钟域，复位sensor信号，高有效
	wire															clk_gtx						;	//rxaui输出，156.25MHz，
	wire															clk_osc_bufg				;	//clock_reset输出，40MHz，与clk_osc同频同相，用于锁相环的失锁检测
	wire															clk_ref						;	//clock_reset输出，200MHz，IODELAY2参考时钟
	wire															clk_gev						;	//clock_reset输出，180MHz，gige_vision工作时钟
	wire															clk_mig						;	//clock_reset输出，40MHz，ddr控制器驱动时钟，如果晶振在ddr bank同侧，则外部时钟经过ibufg后直接输出；如果晶振在ddr bank异侧，则外部时钟经过ibufg后还需经过bufg再输出
	wire															clk_pix						;	//clock_reset输出，72MHz，像素时钟
	wire															clk_microb					;	//clock_reset输出，50MHz，microblaze驱动时钟
	wire															clk_icap					;	//clock_reset输出，12.5MHz，icap_wrap模块驱动时钟
	wire															clk_drp						;	//clock_reset输出，50MHz，输出给RXAUI的DRP时钟
	wire															clk_frame_buf				;	//frame_buffer输出，100MHz

	wire															reset_osc_bufg				;	//clock_reset输出，clk_osc_bufg时钟域复位信号
	wire															reset_rxaui					;	//clock_reset输出，clk_microb 时钟域，输出给rxaui的复位信号，与reset_microb同源
	wire															reset_pix					;	//clock_reset输出，clk_pix时钟域复位信号
	wire															reset_microb				;	//clock_reset输出，clk_microb时钟域复位信号
	wire															reset_icap					;	//clock_reset输出，clk_icap时钟域复位信号
	wire															reset_mig					;	//clock_reset输出，clk_mig时钟域复位信号
	wire															reset_gtx					;	//clock_reset输出，clk_gtx时钟域复位信号
	wire															reset_frame_buf				;	//frame_buffer输出，clk_frame_buf时钟域复位信号

	wire															w_sensor_reset_done			;	//clock_reset输出，clk_osc_bufg时钟域，sensor复位完成信号，高有效
	wire															w_interface_generator_locked;	//clock_reset输出，时钟域未知，使用端需要做跨时钟域处理


	//	-------------------------------------------------------------------------------------
	//	ctrl channel
	//	-------------------------------------------------------------------------------------
	//  -------------------------------------------------------------------------------------
	//	通用
	//  -------------------------------------------------------------------------------------
	wire															w_stream_enable_pix			;	//ctrl_channel输出，clk_pix时钟域，流开采信号，没有生效时机
	wire															w_acquisition_start_pix		;	//ctrl_channel输出，clk_pix时钟域，开采信号，没有生效时机
	wire															w_stream_enable_frame_buf	;	//ctrl_channel输出，clk_frame_buf时钟域，流开采信号，没有生效时机
	wire															w_stream_enable_gev			;	//ctrl_channel输出，clk_gpif时钟域，流开采信号，没有生效时机
	//  -------------------------------------------------------------------------------------
	//	输出给 io channel
	//  -------------------------------------------------------------------------------------
	wire															w_trigger_mode				;	//ctrl_channel输出，clk_pix时钟域，触发模式寄存器，没做生效时机控制
	wire	[3:0]													wv_trigger_source			;	//ctrl_channel输出，clk_pix时钟域，触发源寄存器，没做生效时机控制
	wire															w_trigger_soft				;	//ctrl_channel输出，clk_pix时钟域，软触发寄存器，控制通道自清零，宽度是1个时钟周期
	wire															w_trigger_active			;	//ctrl_channel输出，clk_pix时钟域，触发有效沿寄存器，没做生效时机控制
	wire	[REG_WD-1:0]											wv_trigger_filter_rise		;	//ctrl_channel输出，clk_pix时钟域，上升沿触发滤波寄存器，没做生效时机控制，但保证成组生效
	wire	[REG_WD-1:0]											wv_trigger_filter_fall		;	//ctrl_channel输出，clk_pix时钟域，下降沿触发滤波寄存器，没做生效时机控制，但保证成组生效
	wire	[REG_WD-1:0]											wv_trigger_delay			;	//ctrl_channel输出，clk_pix时钟域，触发延迟寄存器，没做生效时机控制，但保证成组生效
	wire	[2:0]													wv_useroutput_level			;	//ctrl_channel输出，clk_pix时钟域，用户自定义输出寄存器，没做生效时机控制
	wire															w_line2_mode				;	//ctrl_channel输出，clk_pix时钟域，line2输入输出模式寄存器
	wire															w_line3_mode				;	//ctrl_channel输出，clk_pix时钟域，line3输入输出模式寄存器
	wire															w_line0_invert				;	//ctrl_channel输出，clk_pix时钟域，line0极性寄存器
	wire															w_line1_invert				;	//ctrl_channel输出，clk_pix时钟域，line1极性寄存器
	wire															w_line2_invert				;	//ctrl_channel输出，clk_pix时钟域，line2极性寄存器
	wire															w_line3_invert				;	//ctrl_channel输出，clk_pix时钟域，line3极性寄存器
	wire	[2:0]													wv_line_source1				;	//ctrl_channel输出，clk_pix时钟域，line1的输出源选择寄存器
	wire	[2:0]													wv_line_source2				;	//ctrl_channel输出，clk_pix时钟域，line2的输出源选择寄存器
	wire	[2:0]													wv_line_source3				;	//ctrl_channel输出，clk_pix时钟域，line3的输出源选择寄存器
	wire	[4:0]													wv_led_ctrl					;	//ctrl_channel输出，clk_pix时钟域，双色灯控制寄存器
	wire	[3:0]													wv_line_status				;	//io_channel输出，clk_pix时钟域，line状态寄存器，指示IO进行选择后状态

	//	-------------------------------------------------------------------------------------
	//	sensor_channel_python
	//	-------------------------------------------------------------------------------------
	wire															w_full_frame_sensor			;	//sensor_channnel_python输出，clk_pix时钟域，完整帧标志，1--图像正在输出，0--图像输出完毕
	wire	[3:0]													wv_stop_info				;	//sensor_channnel_python输出，clk_pix时钟域，用于调试，停采信号
	wire	[2:0]													wv_pad_info					;	//sensor_channnel_python输出，clk_pix时钟域，用于调试，引脚上的信号
	wire	[2:0]													wv_state_info				;	//sensor_channnel_python输出，clk_pix时钟域，用于调试，状态机的信息
	wire															w_trigger_mask				;	//sensor_channnel_python输出，clk_axi 时钟域，触发屏蔽事件时间戳更新标志
	wire															w_trigger_valid_ccd_pix		;	//sensor_channnel_python输出，clk_sensor 时钟域，有效的触发信号
	wire															w_deser_pll_lock			;	//sensor_channnel_python输出，clk_recover时钟域，解串的mmcm锁定信号，高有效
	wire															w_deser_done				;	//sensor_channnel_python输出，clk_recover时钟域，字边界对齐完成标志，表示解析成功
	wire															w_sensor_init_done			;	//ctrl_channel输出，clk_pix时钟域，Sensor初始化完成信号

	wire															w_clk_en_recover			;	//sensor_channnel_python输出，clk_recover时钟域，时钟使能信号
	wire															w_fval_recover				;	//sensor_channnel_python输出，clk_recover时钟域，输出场有效信号
	wire															w_lval_recover				;	//sensor_channnel_python输出，clk_recover时钟域，输出行有效信号
	wire	[SENSOR_DAT_WIDTH*CHANNEL_NUM-1:0]						wv_pix_data_recover			;	//sensor_channnel_python输出，clk_recover时钟域，输出像素数据

	wire	[SHORT_REG_WD-1:0]										wv_python_exposure_delay	;	//ctrl_channel输出，clk_pix时钟域，python系列曝光延时寄存器
	wire	[REG_WD-1:0]											wv_python_exposure_time		;	//ctrl_channel输出，clk_pix时钟域，python系列曝光时间寄存器
	wire	[REG_WD-1:0]											wv_python_trigger_interval	;	//ctrl_channel输出，clk_pix时钟域，python系列触发间隔寄存器
	wire	[REG_WD-1:0]											wv_python_readout_time		;	//ctrl_channel输出，clk_pix时钟域，python系列图像读出时间寄存器

	//	-------------------------------------------------------------------------------------
	//
	//	-------------------------------------------------------------------------------------
	wire	[REG_WD-1:0]											wv_pixel_format				;	//ctrl_channel输出，clk_pix时钟域，控制通路输出的像素格式寄存器，没做生效时机控制，0x01080001:Mono8、0x01100003:Mono10、0x01080008:BayerGR8、0x0110000C:BayerGR10
	wire															w_encrypt_state				;	//ctrl_channel输出，clk_dna时钟域，加密状态，上电后保持不变，可以作为常数
	wire	[REG_WD-1:0]											wv_pixel_format_data_channel;	//data_channel输出，clk_pix时钟域，目的是让后级模块与数据通道的像素格式保持一致
	wire															w_fval_data_channel			;	//data_channel输出，clk_pix时钟域，场有效，o_fval与o_lval的相位要保证与输入的相位一致
	wire															w_lval_data_channel			;	//data_channel输出，clk_pix时钟域，行有效
	wire	[SENSOR_DAT_WIDTH*CHANNEL_NUM-1:0]						wv_pix_data_data_channel	;	//data_channel输出，clk_pix时钟域，图像数据



	wire															w_fval_frame_info			;	//data_channel输出，clk_pix时钟域，场有效信号，高有效
	wire															w_dval_frame_info			;	//data_channel输出，clk_pix时钟域，数据有效信号，高有效，数据有效不像行信号一样连续，可以是断续的信号
	wire															w_info_flag_frame_info		;	//data_channel输出，clk_pix时钟域，信息段标志，高有效
	wire															w_image_flag_frame_info		;	//data_channel输出，clk_pix时钟域，图像段标志，高有效
	wire															w_statis_flag_frame_info	;	//data_channel输出，clk_pix时钟域，统计段标志，高有效
	wire	[FRAME_BUF_DATA_WD-1:0]											wv_data_frame_info			;	//data_channel输出，clk_pix时钟域，图像数据，位宽可变，支持64 128 256
	wire															w_sensor_strobe				;	//sensor控制通道输出的闪光灯信号i_sensor_strobe
	wire															w_trigger_n					;	//IO通道触发信号



	wire															w_fb_rd						;	//gige_vision输出，clk_gev时钟域，帧存后端fifo读出使能信号，高有效
	wire															w_fb_empty					;	//frame_buffer输出，clk_gev时钟域，帧存后端fifo空信号，高有效
	wire	[GEV_DE_WD-1:0]											wv_data_is_cmd_frame_buf	;	//frame_buffer输出，帧存后端fifo输出数据是命令数据，单bit代表4byte，1-表示是命令数据，0-表示是图像数据
	wire	[GEV_DE_WD-1:0]											wv_dval_frame_buf			;	//frame_buffer输出，帧存后端fifo输出数据有效信号，单bit代表4byte，1-表示数据有效，0-表示数据无效
	wire	[GEV_DATA_WD-1:0]										wv_data_frame_buf			;	//frame_buffer输出，帧存后端fifo输出数据，支持32、64、128



	wire															w_test_pkt_enable_gev			;	//clk_gev时钟域，测试包发送使能
	wire															w_test_pkt_over_gev				;	//clk_gev时钟域，测试包发送完成，1个clk的高脉冲，寄存器模块接收到该信号后清i_test_pkt_enable
	wire	[31:0]													wv_pc_ip_gev					;	//clk_gev时钟域，ip pc address
	wire	[31:0]													wv_camera_ip_gev				;	//clk_gev时钟域，ip camera address
	wire	[15:0]													wv_pc_port_sc_gev				;	//clk_gev时钟域，stream channel gvsp包pc端口号
	wire	[15:0]													wv_camera_port_gev				;	//clk_gev时钟域，相机udp端口号
	wire	[PKT_LENGTH_WD-1:0]										wv_pkt_length_gev				;	//clk_gev时钟域，packet length 正常包包长,仅payload部分，不包括ip、udp、gvsp头
	wire	[PKT_CNT_WD-1:0]										wv_pkt_cnt_gev					;	//clk_gev时钟域，packet cnt 正常包个数(包含帧信息部分)
	wire	[PKT_LENGTH_WD-1:0]										wv_remain_pkt_length_gev		;	//clk_gev时钟域，remain packet length 残包包长(包含帧信息部分)
	wire	[SHORT_REG_WD-1:0]										wv_gvcp_length_gtx				;	//clk_gtx时钟域，gvcp包长
	wire	[47:0]													wv_pc_mac_gtx					;	//clk_gtx时钟域，mac pc address
	wire	[47:0]													wv_camera_mac_gtx				;	//clk_gtx时钟域，mac camera address
	wire	[REG_WD-1:0]											wv_packet_gap_gtx				;	//clk_gtx时钟域，包间隔,单位8byte,最小值为2
	wire															w_gvcp_ack_txen_gtx				;	//clk_gtx时钟域，gvcp发送使能，高有效，固件置位，fpga清0
	wire															w_gvcp_ack_tx_start_gtx			;	//clk_gtx时钟域，gvcp开始发送信号，单脉冲信号，高有效，当该信号为1时，将gvcp_ack_txen清0
	wire	[4*8-1	:0]												wv_camera_ip_gtx				;	//clk_gtx时钟域，相机ip
	wire	[4*8-1	:0]												wv_pc_ip_gtx					;	//clk_gtx时钟域，pc的ip
	wire	[4*8-1	:0]												wv_ip_mask_gtx					;	//clk_gtx时钟域，ip掩码，discover相机时使用
	wire	[2*8-1	:0]												wv_pc_port_cc_gtx				;	//clk_gtx时钟域，gvcp control channel命令包pc源端口号，用于清心跳
	wire	[2*8-1	:0]												wv_pc_port_mc_gtx				;	//clk_gtx时钟域，gvcp message channel应答包pc源端口号
	wire	[REG_WD-1:0]											wv_irq_status_gtx				;	//clk_gtx时钟域，中断状态寄存器，指示当前中断的状态类型.bit0位和bit1位分别指示gvcp_rx_ram中两片存储空间的状态
	wire															w_mac_valid_gtx					;	//clk_gtx时钟域, 输出数据有效信号，上升沿可以表示一帧的开始
	wire															w_protocal_match_gtx			;	//clk_gtx时钟域，输出给异步时钟域，协议匹配标志，包括arp、icmp、dhcp、gvcp协议
	wire															w_heartbeat_clr_gtx				;	//clk_gtx时钟域，输出给异步时钟域，清心跳标志
	wire	[LONG_REG_WD-1:0]										wv_resend_block_id_gtx			;	//clk_gtx时钟域，block id
	wire	[REG_WD-1:0]											wv_resend_packet_id_first_gtx	;	//clk_gtx时钟域，packet id first，重传起始
	wire	[REG_WD-1:0]											wv_resend_packet_id_last_gtx	;	//clk_gtx时钟域，packet id last，重传结束
	wire															w_resend_en_gtx					;	//clk_gtx时钟域，ov_resend_cmd写使能，发送给重传命令fifo，高有效
	//axi


	wire	[AXI_ADDR_WD-1:0]										wv_axi_addr						;	//clk_axi时钟域，axi 地址
	wire	[AXI_DATA_WD/8-1:0]										wv_axi_be						;	//clk_axi时钟域，axi 字节使能
	wire															w_axi_wr_en						;	//clk_axi时钟域，axi 写使能
	wire	[AXI_DATA_WD-1:0]										wv_axi_wr_data					;	//clk_axi时钟域，axi 写数据
	wire	[AXI_DATA_WD-1:0]										wv_axi_rd_data					;	//clk_axi时钟域，axi 写数据



	//  -------------------------------------------------------------------------------------
	//	与 mac 交互，axi stream 信号
	//  -------------------------------------------------------------------------------------
	wire	[7:0]													wv_tx_ifg_delay					;	//clk_gtx时钟域，mac控制包间隔输入端口，本设计中设置为0，使用状态机控制包间隔
	wire															w_tx_axis_aresetn				;	//clk_gtx时钟域，mac发送端复位信号
	wire	[MAC_DATA_WD-1:0]										wv_tx_axis_tdata				;	//clk_gtx时钟域，
	wire	[MAC_BE_WD-1:0]											wv_tx_axis_tkeep				;	//clk_gtx时钟域，
	wire															w_tx_axis_tvalid				;	//clk_gtx时钟域，
	wire															w_tx_axis_tlast					;	//clk_gtx时钟域，
	wire															w_tx_axis_tuser					;	//clk_gtx时钟域，
	wire															w_tx_axis_tready				;	//clk_gtx时钟域，
	wire	[MAC_DATA_WD-1:0]										wv_rx_axis_tdata				;	//clk_grx时钟域，
	wire	[MAC_BE_WD-1:0]											wv_rx_axis_tkeep				;	//clk_grx时钟域，
	wire															w_rx_axis_tvalid				;	//clk_grx时钟域，
	wire															w_rx_axis_tlast					;	//clk_grx时钟域，
	wire															w_rx_axis_tuser					;	//clk_grx时钟域，


	//	-------------------------------------------------------------------------------------
	//	microblaze
	//	-------------------------------------------------------------------------------------
	wire	[31:0]													m_axi_if_araddr					;
	wire	[2:0]													m_axi_if_arprot					;
	wire	[0:0]													m_axi_if_arready				;
	wire	[0:0]													m_axi_if_arvalid				;
	wire	[31:0]													m_axi_if_awaddr					;
	wire	[2:0]													m_axi_if_awprot					;
	wire	[0:0]													m_axi_if_awready				;
	wire	[0:0]													m_axi_if_awvalid				;
	wire	[0:0]													m_axi_if_bready					;
	wire	[1:0]													m_axi_if_bresp					;
	wire	[0:0]													m_axi_if_bvalid					;
	wire	[31:0]													m_axi_if_rdata					;
	wire	[0:0]													m_axi_if_rready					;
	wire	[1:0]													m_axi_if_rresp					;
	wire	[0:0]													m_axi_if_rvalid					;
	wire	[31:0]													m_axi_if_wdata					;
	wire	[0:0]													m_axi_if_wready					;
	wire	[3:0]													m_axi_if_wstrb					;
	wire	[0:0]													m_axi_if_wvalid					;
	wire															clk_axi							;


	//	ref ARCHITECTURE







	//	===============================================================================================
	//	ref ****** auxiliary module ******
	//	===============================================================================================
	//	-------------------------------------------------------------------------------------
	//	时钟复位模块
	//	-------------------------------------------------------------------------------------
	clock_reset # (
	.SIMULATION							(SIMULATION							)
	)
	clock_reset_inst (
	.clk_osc							(clk_osc							),
	.i_rxaui_locked						(w_rxaui_locked						),
	.i_phy_speed_change					(1'b0								),				//速率改变信号，是否暂时不用？？
	.i_reset_sensor						(w_reset_sensor						),
	.clk_gtx							(clk_gtx							),
	.clk_osc_bufg						(clk_osc_bufg						),
	.clk_ref							(clk_ref							),
	.clk_gev							(clk_gev							),
	.clk_mig							(clk_mig							),
	.clk_pix							(clk_pix							),
	.clk_microb							(clk_microb							),
	.clk_icap							(clk_icap							),
	.clk_drp							(clk_drp							),
	.o_clk_sensor_diff_p				(o_clk_sensor_diff_p				),
	.o_clk_sensor_diff_n				(o_clk_sensor_diff_n				),
	.reset_osc_bufg						(reset_osc_bufg						),
	.reset_rxaui						(reset_rxaui						),
	.reset_pix							(reset_pix							),
	.reset_microb						(reset_microb						),
	.reset_icap							(reset_icap							),
	.reset_mig							(reset_mig							),
	.reset_gtx							(reset_gtx							),
	.o_enet_rstn						(									),				//外部phy复位信号，暂时不用？？
	.o_reset_sensor_n					(o_reset_sensor_n					),
	.o_sensor_reset_done				(w_sensor_reset_done				),
	.o_interface_generator_locked		(w_interface_generator_locked		)
	);

	//	-------------------------------------------------------------------------------------
	//	io_channel
	//	-------------------------------------------------------------------------------------
	io_channel # (
	.REG_WD								(REG_WD								),
	.LED_CTRL_WIDTH						(LED_CTRL_WIDTH						),
	.PIX_CLK_FREQ_KHZ					(PIX_CLK_FREQ_KHZ					)
	)
	io_channel_inst (
	.clk								(clk_pix							),
	.i_trigger_mode						(w_trigger_mode						),
	.i_acquisition_start				(w_acquisition_start_pix			),
	.i_stream_enable					(w_stream_enable_pix				),
	.ov_line_status						(wv_line_status						),
	.i_line2_mode						(w_line2_mode						),
	.i_line3_mode						(w_line3_mode						),
	.i_line0_invert						(w_line0_invert						),
	.i_line1_invert						(w_line1_invert						),
	.i_line2_invert						(w_line2_invert						),
	.i_line3_invert						(w_line3_invert						),
	.iv_filter_rise						(wv_trigger_filter_rise				),
	.iv_filter_fall						(wv_trigger_filter_fall				),
	.i_trigger_soft						(w_trigger_soft						),
	.iv_trigger_source					(wv_trigger_source					),
	.i_trigger_active					(w_trigger_active					),
	.iv_trigger_delay					(wv_trigger_delay					),
	.iv_line_source1					(wv_line_source1					),
	.iv_line_source2					(wv_line_source2					),
	.iv_line_source3					(wv_line_source3					),
	.iv_useroutput_level				(wv_useroutput_level				),
	.iv_led_ctrl						(wv_led_ctrl						),
	.i_optocoupler						(i_optocoupler						),
	.iv_gpio							(iv_gpio							),
	.o_optocoupler						(o_optocoupler						),
	.ov_gpio							(ov_gpio							),
	.o_f_led_gre						(o_f_led_gre						),
	.o_f_led_red						(o_f_led_red						),
	.i_usb_slwr_n						(!w_tx_axis_tvalid					),
	.i_sensor_strobe					(w_sensor_strobe					),
	.o_trigger_n						(w_trigger_n						)
	);

	//	//	-------------------------------------------------------------------------------------
	//	//	ctrl_channel
	//	//	-------------------------------------------------------------------------------------
	//	ctrl_channel # (
	//	.WIDTH_HEIGHT_WD			(WIDTH_HEIGHT_WD				),
	//	.WB_GAIN_WIDTH				(WB_GAIN_WIDTH					),
	//	.WB_STATIS_WIDTH			(WB_STATIS_WIDTH				),
	//	.WB_UNSAT_NUM_WIDTH			(WB_UNSAT_NUM_WIDTH				),
	//	.GREY_OFFSET_WIDTH			(GREY_OFFSET_WIDTH				),
	//	.GREY_STATIS_WIDTH			(GREY_STATIS_WIDTH				),
	//	.TRIG_FILTER_WIDTH			(TRIG_FILTER_WIDTH				),
	//	.TRIG_DELAY_WIDTH			(TRIG_DELAY_WIDTH				),
	//	.LED_CTRL_WIDTH				(LED_CTRL_WIDTH					),
	//	.SHORT_REG_WD				(SHORT_REG_WD					),
	//	.REG_WD						(REG_WD							),
	//	.LONG_REG_WD				(LONG_REG_WD					),
	//	.MROI_NUM_MAX				(MROI_NUM_MAX					),
	//	.PACKET_SIZE_WD				(PACKET_SIZE_WD					),
	//	.FVAL_RISE_TS				(FVAL_RISE_TS					),
	//	.FVAL_FALL_TS				(FVAL_FALL_TS					)
	//	)
	//	ctrl_channel_inst (
	//	//  ===============================================================================================
	//	//	控制信号
	//	//  ===============================================================================================
	//	//  ---------------------------------------------------------------------------------------------
	//	//	spi时钟域
	//	//  ---------------------------------------------------------------------------------------------
	//	.i_spi_clk					(i_usb_spi_sck			        ),
	//	.i_spi_cs_n					(i_spi_cs_n_fpga		        ),
	//	.i_spi_mosi					(i_usb_spi_mosi			        ),
	//	.o_spi_miso_data			(w_spi_miso_data		        ),
	//	.o_spi_miso_data_en			(w_spi_miso_data_en		        ),
	//	//  ---------------------------------------------------------------------------------------------
	//	//	clk_spi_sample也就是clk_gpif时钟域
	//	//  ---------------------------------------------------------------------------------------------
	//	.o_wr_en					(w_wr_en				        ),
	//	.ov_addr					(wv_addr				        ),
	//	.ov_wr_data					(wv_wr_data				        ),
	//	//  ---------------------------------------------------------------------------------------------
	//	//	40MHz时钟
	//	//  ---------------------------------------------------------------------------------------------
	//	.clk_osc_bufg				(clk_osc_bufg			        ),
	//	.reset_osc_bufg				(reset_osc_bufg			        ),
	//	//  ---------------------------------------------------------------------------------------------
	//	//	pix 时钟域
	//	//  ---------------------------------------------------------------------------------------------
	//	.clk_pix				    (clk_pix				        ),
	//	.reset_pix					(reset_pix				        ),
	//	.i_fval						(w_fval_data_channel	        ),
	//	//  ---------------------------------------------------------------------------------------------
	//	//	frame buf 时钟域
	//	//  ---------------------------------------------------------------------------------------------
	//	.clk_frame_buf			    (clk_frame_buf			        ),
	//	.reset_frame_buf			(reset_frame_buf		        ),
	//	//  ---------------------------------------------------------------------------------------------
	//	//	gpif 时钟域
	//	//  ---------------------------------------------------------------------------------------------
	//	.clk_gpif			        (clk_gpif						),
	//	.reset_gpif					(reset_gpif						),
	//	//  ===============================================================================================
	//	//	以下内容是寄存器
	//	//  ===============================================================================================
	//	//  -------------------------------------------------------------------------------------
	//	//	通用
	//	//  -------------------------------------------------------------------------------------
	//	.o_stream_enable_pix		(w_stream_enable_pix			),
	//	.o_acquisition_start_pix	(w_acquisition_start_pix		),
	//	.o_stream_enable_frame_buf	(w_stream_enable_frame_buf		),
	//	.o_stream_enable_gpif		(w_stream_enable_gpif			),
	//	//  -------------------------------------------------------------------------------------
	//	//	clk reset top
	//	//  -------------------------------------------------------------------------------------
	//	.o_reset_sensor				(w_reset_sensor					),
	//	.i_sensor_reset_done		(w_sensor_reset_done			),
	//	//  -------------------------------------------------------------------------------------
	//	//	python_slave_ctrl
	//	//	-------------------------------------------------------------------------------------
	//	.ov_python_exposure_delay	(wv_python_exposure_delay		),
	//	.ov_python_exposure_time	(wv_python_exposure_time		),
	//	.ov_python_trigger_interval	(wv_python_trigger_interval		),
	//	.ov_python_readout_time		(wv_python_readout_time			),
	//	.iv_stop_info				(wv_stop_info	    			),
	//	.iv_pad_info		        (wv_pad_info					),
	//	.iv_state_info	            (wv_state_info	    			),
	//	//  -------------------------------------------------------------------------------------
	//	//	io channel
	//	//  -------------------------------------------------------------------------------------
	//	.o_trigger_mode				(w_trigger_mode					),
	//	.ov_trigger_source			(wv_trigger_source				),
	//	.o_trigger_soft				(w_trigger_soft					),
	//	.o_trigger_active			(w_trigger_active				),
	//	.ov_trigger_filter_rise		(wv_trigger_filter_rise			),
	//	.ov_trigger_filter_fall		(wv_trigger_filter_fall			),
	//	.ov_trigger_delay			(wv_trigger_delay				),
	//	.ov_useroutput_level		(wv_useroutput_level			),
	//	.o_line2_mode				(w_line2_mode					),
	//	.o_line3_mode				(w_line3_mode					),
	//	.o_line0_invert				(w_line0_invert					),
	//	.o_line1_invert				(w_line1_invert					),
	//	.o_line2_invert				(w_line2_invert					),
	//	.o_line3_invert				(w_line3_invert					),
	//	.ov_line_source1			(wv_line_source1				),
	//	.ov_line_source2			(wv_line_source2				),
	//	.ov_line_source3			(wv_line_source3				),
	//	.iv_line_status				(wv_line_status					),
	//	.ov_led_ctrl				(wv_led_ctrl					),
	//
	//	//  -------------------------------------------------------------------------------------
	//	//	data channel
	//	//  -------------------------------------------------------------------------------------
	//	.o_reset_des_pll			(w_reset_des_pll				),
	//	.i_fpga_des_pll_state      	(w_fpga_des_pll_state      		),
	//	.i_fpga_deserializer_state 	(w_fpga_deserializer_state 		),
	//	.o_sensor_init_done			(w_sensor_init_done				),
	//	.ov_pixel_format			(wv_pixel_format				),
	//	.ov_trigger_min_period		(wv_trigger_period_us			),
	//	.i_full_frame_state			(w_full_frame_state		    	),
	//	.o_encrypt_state			(w_encrypt_state				),
	//	.o_pulse_filter_en			(w_pulse_filter_en				),
	//	.o_python_stripe_en			(w_python_stripe_en				),
	//	.ov_test_image_sel			(wv_test_image_sel		    	),
	//	.ov_interrupt_en			(wv_interrupt_en		    	),
	//	.iv_interrupt_state			(wv_interrupt_state		    	),
	//	.ov_interrupt_clear			(wv_interrupt_clear		    	),
	//	.ov_wb_offset_x_start		(wv_wb_offset_x_start	    	),
	//	.ov_wb_offset_width			(wv_wb_offset_width		    	),
	//	.ov_wb_offset_y_start		(wv_wb_offset_y_start	    	),
	//	.ov_wb_offset_height		(wv_wb_offset_height	    	),
	//	.ov_wb_gain_r				(wv_wb_gain_r			    	),
	//	.ov_wb_gain_g				(wv_wb_gain_g			    	),
	//	.ov_wb_gain_b				(wv_wb_gain_b			    	),
	//	.iv_wb_statis_r				(wv_wb_statis_r			    	),
	//	.iv_wb_statis_g				(wv_wb_statis_g			    	),
	//	.iv_wb_statis_b				(wv_wb_statis_b			    	),
	//	.iv_wb_num_r				(wv_wb_num_r					),
	//	.iv_wb_num_b				(wv_wb_num_b					),
	//	.iv_wb_offset_width			(wv_wb_offset_width_valid   	),
	//	.iv_wb_offset_height		(wv_wb_offset_height_valid  	),
	//	.ov_grey_offset_x_start		(wv_grey_offset_x_start	    	),
	//	.ov_grey_offset_width		(wv_grey_offset_width	    	),
	//	.ov_grey_offset_y_start		(wv_grey_offset_y_start	    	),
	//	.ov_grey_offset_height		(wv_grey_offset_height	    	),
	//	.iv_grey_statis_sum			(wv_grey_statis_sum		    	),
	//	.iv_grey_offset_width		(wv_grey_offset_width_valid 	),
	//	.iv_grey_offset_height		(wv_grey_offset_height_valid	),
	//
	//	//调试用
	//	.iv_fval_state				(wv_fval_state					),
	//	.iv_gpif_state				(wv_gpif_state                  ),
	//	//  -------------------------------------------------------------------------------------
	//	//	u3v format
	//	//  -------------------------------------------------------------------------------------
	//	.o_chunk_mode_active		(w_chunk_mode_active_pix		),
	//	.o_chunkid_en_ts			(w_chunkid_en_ts				),
	//	.o_chunkid_en_fid			(w_chunkid_en_fid				),
	//	//Multi-roi总开关
	//	.o_multi_roi_global_en		(w_multi_roi_global_en),
	//	//sensor输出图像的整体参数
	//	.ov_multi_roi_offset_x		(wv_multi_roi_offset_x		),
	//	//	.ov_multi_roi_offset_y		(wv_multi_roi_offset_y		),
	//	.ov_multi_roi_width			(wv_multi_roi_width			),
	//	//	.ov_multi_roi_height		(wv_multi_roi_height		),
	//	.ov_multi_roi_payload_size	(wv_multi_roi_payload_size	),
	//	.ov_multi_roi_chunk_size_img(wv_multi_roi_chunk_size_img),
	//	.ov_multi_roi_single_en		(wv_multi_roi_single_en		),
	//	//各个roi对应的参数
	//	.ov_single_roi_offset_x		(wv_single_roi_offset_x		),
	//	.ov_single_roi_offset_y		(wv_single_roi_offset_y		),
	//	.ov_single_roi_pic_width	(wv_single_roi_pic_width	),
	//	.ov_single_roi_pic_height	(wv_single_roi_pic_height	),
	//	.ov_single_roi_chunk_size_img(wv_single_roi_chunk_size_img),
	//	.ov_timestamp_u3			(wv_timestamp_u3		),
	//	//  -------------------------------------------------------------------------------------
	//	//	frame buffer
	//	//  -------------------------------------------------------------------------------------
	//	.ov_frame_buffer_depth			(wv_frame_buffer_depth			),
	//	.i_ddr_init_done				(w_ddr_init_done				),
	//	.i_ddr_error					(w_ddr_error					),
	//	.i_front_fifo_overflow			(w_front_fifo_overflow			),
	//	.o_multi_roi_global_en_frame_buffer			(w_multi_roi_global_en_frame_buffer			),
	//	.ov_multi_roi_width_frame_buffer			(wv_multi_roi_width_frame_buffer			),
	//	.ov_single_roi_pic_width_frame_buffer		(wv_single_roi_pic_width_frame_buffer		),
	//	.ov_single_roi_start_frame_buffer			(wv_single_roi_start_frame_buffer			),
	//	//  -------------------------------------------------------------------------------------
	//	//	u3 interface
	//	//  -------------------------------------------------------------------------------------
	//	.ov_si_payload_transfer_size			(wv_si_payload_transfer_size	    	),
	//	.ov_si_payload_transfer_count			(wv_si_payload_transfer_count	    	),
	//	.ov_si_payload_final_transfer1_size		(wv_si_payload_final_transfer1_size		),
	//	.ov_si_payload_final_transfer2_size		(wv_si_payload_final_transfer2_size		),
	//	.o_chunk_mode_active_gpif				(w_chunk_mode_active_gpif				),
	//	.ov_single_roi_payload_size_gpif		(wv_single_roi_payload_size_gpif		)
	//	);


	ctrl_channel # (
	.SHORT_REG_WD						(SHORT_REG_WD						),
	.REG_WD								(REG_WD								),
	.LONG_REG_WD						(LONG_REG_WD						),
	.AXI_WD								(AXI_DATA_WD						),		//AXI 地址位宽 32
	.CTRL_CH_ADDR_WD					(AXI_ADDR_WD						)		//AXI 数据位宽 32
	)
	ctrl_channel_inst (
	//	===============================================================================================
	//	axi 端口
	//	===============================================================================================
	//	-------------------------------------------------------------------------------------
	//	时钟复位
	//	-------------------------------------------------------------------------------------
	.reset_axi							(reset_axi							),
	.clk_axi							(clk_axi							),
	//	-------------------------------------------------------------------------------------
	//	axi 时钟域
	//	-------------------------------------------------------------------------------------
	.iv_raddr_axi						(wv_raddr_axi						),
	.iv_waddr_axi						(wv_waddr_axi						),
	.iv_wdata_axi						(wv_wdata_axi						),
	.i_rd_en_axi						(w_rd_en_axi						),
	.i_rd_valid_axi						(w_rd_valid_axi						),
	.i_wr_en_axi						(w_wr_en_axi						),
	.i_wr_valid_axi						(w_wr_valid_axi						),
	.ov_rdata_axi						(wv_rdata_axi						),
	//	-------------------------------------------------------------------------------------
	//	sensor 时钟域
	//	-------------------------------------------------------------------------------------
	.reset_sensor						(reset_sensor						),
	.clk_sensor							(clk_sensor							),
	.iv_raddr_sensor					(wv_raddr_sensor					),
	.iv_waddr_sensor					(wv_waddr_sensor					),
	.iv_wdata_sensor					(wv_wdata_sensor					),
	.i_rd_en_sensor						(w_rd_en_sensor						),
	.i_rd_valid_sensor					(w_rd_valid_sensor					),
	.i_wr_en_sensor						(w_wr_en_sensor						),
	.i_wr_valid_sensor					(w_wr_valid_sensor					),
	.ov_rdata_sensor					(wv_rdata_sensor					),
	//	-------------------------------------------------------------------------------------
	//	pix 时钟域
	//	-------------------------------------------------------------------------------------
	.reset_pix							(reset_pix							),
	.clk_pix							(clk_pix							),
	.iv_raddr_pix						(wv_raddr_pix						),
	.iv_waddr_pix						(wv_waddr_pix						),
	.iv_wdata_pix						(wv_wdata_pix						),
	.i_rd_en_pix						(w_rd_en_pix						),
	.i_rd_valid_pix						(w_rd_valid_pix						),
	.i_wr_en_pix						(w_wr_en_pix						),
	.i_wr_valid_pix						(w_wr_valid_pix						),
	.ov_rdata_pix						(wv_rdata_pix						),
	//	-------------------------------------------------------------------------------------
	//	fb 时钟域
	//	-------------------------------------------------------------------------------------
	.reset_fb							(reset_fb							),
	.clk_fb								(clk_fb								),
	.iv_raddr_fb						(wv_raddr_fb						),
	.iv_waddr_fb						(wv_waddr_fb						),
	.iv_wdata_fb						(wv_wdata_fb						),
	.i_rd_en_fb							(w_rd_en_fb							),
	.i_rd_valid_fb						(w_rd_valid_fb						),
	.i_wr_en_fb							(w_wr_en_fb							),
	.i_wr_valid_fb						(w_wr_valid_fb						),
	.ov_rdata_fb						(ov_rdata_fb						),
	//	-------------------------------------------------------------------------------------
	//	gev 时钟域
	//	-------------------------------------------------------------------------------------
	.reset_gev							(reset_gev							),
	.clk_gev							(clk_gev							),
	.iv_raddr_gev						(wv_raddr_gev						),
	.iv_waddr_gev						(wv_waddr_gev						),
	.iv_wdata_gev						(wv_wdata_gev						),
	.i_rd_en_gev						(w_rd_en_gev						),
	.i_rd_valid_gev						(w_rd_valid_gev						),
	.i_wr_en_gev						(w_wr_en_gev						),
	.i_wr_valid_gev						(w_wr_valid_gev						),
	.ov_rdata_gev						(wv_rdata_gev						),
	//	===============================================================================================
	//	寄存器 端口
	//	===============================================================================================
	//	-------------------------------------------------------------------------------------
	//	axi 时钟域
	//	-------------------------------------------------------------------------------------
	.iv_state							(iv_state							),
	.o_timestamp_reset					(o_timestamp_reset					),
	.o_timestamp_load					(o_timestamp_load					),
	.ov_timestamp_l						(ov_timestamp_l						),
	.ov_timestamp_h						(ov_timestamp_h						),
	.ov_exposure_timestamp_l			(ov_exposure_timestamp_l			),
	.ov_exposure_timestamp_h			(ov_exposure_timestamp_h			),
	.ov_trig_mask_timestamp_l			(ov_trig_mask_timestamp_l			),
	.ov_trig_mask_timestamp_h			(ov_trig_mask_timestamp_h			),
	.ov_public_timestamp_l				(ov_public_timestamp_l				),
	.ov_public_timestamp_h				(ov_public_timestamp_h				),
	.ov_temperature_sensor				(ov_temperature_sensor				),
	.ov_temperature_be					(ov_temperature_be					),
	.o_load_user_param					(o_load_user_param					),
	.ov_dna_reg_l						(ov_dna_reg_l						),
	.ov_dna_reg_h						(ov_dna_reg_h						),
	.ov_encrypt_reg_l					(ov_encrypt_reg_l					),
	.ov_encrypt_reg_h					(ov_encrypt_reg_h					),
	.o_encrypt_state					(o_encrypt_state					),
	.o_flash_wp							(o_flash_wp							),
	.o_watchdog_enable					(o_watchdog_enable					),
	.ov_watchdog_thd_reg				(ov_watchdog_thd_reg				),
	.ov_watchdog_cnt_reg				(ov_watchdog_cnt_reg				),
	.o_microb_reboot					(o_microb_reboot					),
	.ov_heartbeat_time					(ov_heartbeat_time					),
	.o_irq_global_reg					(o_irq_global_reg					),
	.ov_irq_enable_reg					(ov_irq_enable_reg					),
	.ov_irq_clr_reg						(ov_irq_clr_reg						),
	.ov_irq_status_reg					(ov_irq_status_reg					),
	.ov_event_timeout_cnt				(ov_event_timeout_cnt				),
	.ov_dhcp_timeout					(ov_dhcp_timeout					),
	.o_gvcp_ack_txen					(o_gvcp_ack_txen					),
	//	-------------------------------------------------------------------------------------
	//	sensor 时钟域
	//	-------------------------------------------------------------------------------------
	.ov_gvcp_ack_length					(ov_gvcp_ack_length					),
	.o_acquisition_start				(o_acquisition_start				),
	.ov_useroutput_level				(ov_useroutput_level				),
	.ov_physic_line0					(ov_physic_line0					),
	.ov_physic_line1					(ov_physic_line1					),
	.ov_physic_line2					(ov_physic_line2					),
	.ov_physic_line3					(ov_physic_line3					),
	.iv_line_status						(iv_line_status						),
	.ov_linein_sel_rise_cnt				(ov_linein_sel_rise_cnt				),
	.ov_linein_sel_fall_cnt				(ov_linein_sel_fall_cnt				),
	.ov_linein_filter_rise_cnt			(ov_linein_filter_rise_cnt			),
	.ov_linein_filter_fall_cnt			(ov_linein_filter_fall_cnt			),
	.ov_linein_active_cnt				(ov_linein_active_cnt				),
	.ov_trigger_n_rise_cnt				(ov_trigger_n_rise_cnt				),
	.ov_trigger_mode					(ov_trigger_mode					),
	.ov_trigger_source					(ov_trigger_source					),
	.ov_trigger_soft					(ov_trigger_soft					),
	.ov_trigger_active					(ov_trigger_active					),
	.ov_trigger_filter_rise				(ov_trigger_filter_rise				),
	.ov_trigger_filter_fall				(ov_trigger_filter_fall				),
	.ov_trigger_delay					(ov_trigger_delay					),
	.ov_frame_period_us					(ov_frame_period_us					),
	.ov_frame_period_line				(ov_frame_period_line				),
	.ov_trigger_soft_cnt				(ov_trigger_soft_cnt				),
	.ov_strobe_length					(ov_strobe_length					),
	.ov_exposure_time					(ov_exposure_time					),
	.ov_led_ctrl						(ov_led_ctrl						),
	.o_reset_sensor						(o_reset_sensor						),
	.o_sensor_init_done					(o_sensor_init_done					),
	.o_reset_deser_pll					(o_reset_deser_pll					),
	.ov_slave_hmax						(ov_slave_hmax						),
	.ov_slave_exposure_delay			(ov_slave_exposure_delay			),
	.ov_slave_exposure_time				(ov_slave_exposure_time				),
	.ov_slave_trigger_interval			(ov_slave_trigger_interval			),
	.ov_imx_stop_info					(ov_imx_stop_info					),
	.ov_imx_pad_info					(ov_imx_pad_info					),
	.ov_imx_state_info					(ov_imx_state_info					),
	.ov_python_exposure_delay			(ov_python_exposure_delay			),
	.ov_python_exposure_time			(ov_python_exposure_time			),
	.ov_python_trigger_interval			(ov_python_trigger_interval			),
	.ov_python_readout_time				(ov_python_readout_time				),
	//	-------------------------------------------------------------------------------------
	//	pix 时钟域
	//	-------------------------------------------------------------------------------------
	.o_param_cfg_done					(o_param_cfg_done					),
	.ov_pixel_format					(ov_pixel_format					),
	.ov_test_image_sel					(ov_test_image_sel					),
	.ov_sensor_offset_x					(ov_sensor_offset_x					),
	.ov_sensor_offset_y					(ov_sensor_offset_y					),
	.ov_sensor_width					(ov_sensor_width					),
	.ov_sensor_height					(ov_sensor_height					),
	.ov_single_roi_offset_x_0			(ov_single_roi_offset_x_0			),
	.ov_single_roi_offset_y_0			(ov_single_roi_offset_y_0			),
	.ov_single_roi_pic_width_0			(ov_single_roi_pic_width_0			),
	.ov_single_roi_pic_height_0			(ov_single_roi_pic_height_0			),
	.ov_reverse_xy						(ov_reverse_xy						),
	.ov_binning_mode					(ov_binning_mode					),
	.ov_binning_region_x				(ov_binning_region_x				),
	.ov_binning_region_y				(ov_binning_region_y				),
	.ov_roi_offsetx_bf_binning			(ov_roi_offsetx_bf_binning			),
	.ov_roi_offsety_bf_binning			(ov_roi_offsety_bf_binning			),
	.ov_roi_width_bf_binning			(ov_roi_width_bf_binning			),
	.ov_roi_height_bf_binning			(ov_roi_height_bf_binning			),
	.ov_block_id_l						(ov_block_id_l						),
	.ov_block_id_h						(ov_block_id_h						),
	.ov_frame_interval_l				(ov_frame_interval_l				),
	.ov_frame_interval_h				(ov_frame_interval_h				),
	.ov_wb_offset_x_start				(ov_wb_offset_x_start				),
	.ov_wb_offset_width					(ov_wb_offset_width					),
	.ov_wb_offset_y_start				(ov_wb_offset_y_start				),
	.ov_wb_offset_height				(ov_wb_offset_height				),
	.ov_wb_gain_r						(ov_wb_gain_r						),
	.ov_wb_gain_g						(ov_wb_gain_g						),
	.ov_wb_gain_b						(ov_wb_gain_b						),
	.iv_wb_statis_r						(iv_wb_statis_r						),
	.iv_wb_statis_g						(iv_wb_statis_g						),
	.iv_wb_statis_b						(iv_wb_statis_b						),
	.ov_wb_num_r						(ov_wb_num_r						),
	.ov_wb_num_b						(ov_wb_num_b						),
	.o_unsat_en							(o_unsat_en							),
	.ov_blacklevel_ratio				(ov_blacklevel_ratio				),
	.ov_blacklevel_value				(ov_blacklevel_value				),
	.o_compensate_en					(o_compensate_en					),
	.ov_compensate_gain_0				(ov_compensate_gain_0				),
	.ov_compensate_gain_1				(ov_compensate_gain_1				),
	.ov_grey_offset_x_start				(ov_grey_offset_x_start				),
	.ov_grey_offset_width				(ov_grey_offset_width				),
	.ov_grey_offset_y_start				(ov_grey_offset_y_start				),
	.ov_grey_offset_height				(ov_grey_offset_height				),
	.iv_grey_statis_sum_l				(iv_grey_statis_sum_l				),
	.iv_grey_statis_sum_h				(iv_grey_statis_sum_h				),
	.o_pulse_filter_en					(o_pulse_filter_en					),
	.o_gridding_remove_en				(o_gridding_remove_en				),
	.ov_edge_vote_method				(ov_edge_vote_method				),
	.ov_edge_threshold					(ov_edge_threshold					),
	.o_flat_field_en					(o_flat_field_en					),
	.o_chunk_mode_active				(o_chunk_mode_active				),
	.ov_chunkid_en_img					(ov_chunkid_en_img					),
	.o_chunkid_en_fid					(o_chunkid_en_fid					),
	.o_chunkid_en_ts					(o_chunkid_en_ts					),
	.o_chunkid_en_fint					(o_chunkid_en_fint					),
	.ov_chunk_size_fid					(ov_chunk_size_fid					),
	.ov_chunk_size_ts					(ov_chunk_size_ts					),
	.o_mroi_global_en					(o_mroi_global_en					),
	.ov_mroi_single_en_l				(ov_mroi_single_en_l				),
	.ov_mroi_single_en_h				(ov_mroi_single_en_h				),
	//	-------------------------------------------------------------------------------------
	//	fb 时钟域
	//	-------------------------------------------------------------------------------------
	.ov_single_roi_image_size_0_l		(ov_single_roi_image_size_0_l		),
	.ov_single_roi_image_size_0_h		(ov_single_roi_image_size_0_h		),
	.ov_frame_buffer_depth				(ov_frame_buffer_depth				),
	.o_frame_overwrite_enable			(o_frame_overwrite_enable			),
	.o_transfer_mode					(o_transfer_mode					),
	.o_transfer_start					(o_transfer_start					),
	.o_cache_flush						(o_cache_flush						),
	.ov_cache_frame_cnt					(ov_cache_frame_cnt					),
	.ov_cache_frame_depth				(ov_cache_frame_depth				),
	.ov_cur_pkt_length					(ov_cur_pkt_length					),
	.ov_cur_pic_pkt_cnt					(ov_cur_pic_pkt_cnt					),
	.ov_remain_pkt_length				(ov_remain_pkt_length				),
	//	-------------------------------------------------------------------------------------
	//	gev 时钟域
	//	-------------------------------------------------------------------------------------
	.ov_single_roi_payload_size0_l		(ov_single_roi_payload_size0_l		),
	.ov_single_roi_payload_size0_h		(ov_single_roi_payload_size0_h		),
	.ov_pc_mac_l						(ov_pc_mac_l						),
	.ov_pc_mac_h						(ov_pc_mac_h						),
	.ov_camera_mac_l					(ov_camera_mac_l					),
	.ov_camera_mac_h					(ov_camera_mac_h					),
	.ov_camera_ip						(ov_camera_ip						),
	.ov_pc_ip							(ov_pc_ip							),
	.ov_ip_mask							(ov_ip_mask							),
	.ov_camera_port						(ov_camera_port						),
	.ov_pc_port_sc						(ov_pc_port_sc						),
	.ov_pc_port_cc						(ov_pc_port_cc						),
	.ov_pc_port_mc						(ov_pc_port_mc						),
	.ov_packet_gap						(ov_packet_gap						),
	.o_arp_filter_enable				(o_arp_filter_enable				),
	.ov_gige_functions					(ov_gige_functions					),
	.ov_speed_link						(ov_speed_link						),
	.o_test_pkt_en						(o_test_pkt_en						)
	);




	//	-------------------------------------------------------------------------------------
	//	microblaze
	//	-------------------------------------------------------------------------------------
	microblaze_wrapper microblaze_wrapper_inst (
	.clk_mb								(clk_microb						),
	.i_int_mb               			(1'b0               			),
	.m_axi_if_araddr   					(m_axi_if_araddr   				),
	.m_axi_if_arprot       				(m_axi_if_arprot       			),
	.m_axi_if_arready      				(m_axi_if_arready      			),
	.m_axi_if_arvalid      				(m_axi_if_arvalid      			),
	.m_axi_if_awaddr       				(m_axi_if_awaddr       			),
	.m_axi_if_awprot       				(m_axi_if_awprot       			),
	.m_axi_if_awready      				(m_axi_if_awready      			),
	.m_axi_if_awvalid      				(m_axi_if_awvalid      			),
	.m_axi_if_bready       				(m_axi_if_bready       			),
	.m_axi_if_bresp        				(m_axi_if_bresp        			),
	.m_axi_if_bvalid       				(m_axi_if_bvalid       			),
	.m_axi_if_rdata        				(m_axi_if_rdata        			),
	.m_axi_if_rready       				(m_axi_if_rready       			),
	.m_axi_if_rresp        				(m_axi_if_rresp        			),
	.m_axi_if_rvalid       				(m_axi_if_rvalid       			),
	.m_axi_if_wdata        				(m_axi_if_wdata        			),
	.m_axi_if_wready       				(m_axi_if_wready       			),
	.m_axi_if_wstrb        				(m_axi_if_wstrb        			),
	.m_axi_if_wvalid       				(m_axi_if_wvalid       			),
	.axi_lite_clk						(clk_axi						),
	.i_clk_mb_locked					(w_interface_generator_locked	),
	.i_reset_mb							(reset_microb	     			),
	.iic_scl_io    						(iic_scl_io    					),
	.iic_sda_io    						(iic_sda_io    					),
	.ov_logic_raddr_0       			(wv_raddr_axi					),
	.ov_logic_raddr_1       			(wv_raddr_sensor				),
	.ov_logic_raddr_2       			(wv_raddr_pix					),
	.ov_logic_raddr_3       			(wv_raddr_fb					),
	.ov_logic_raddr_4       			(wv_raddr_gev					),
	.iv_logic_rdata_0       			(wv_rdata_axi					),
	.iv_logic_rdata_1       			(wv_rdata_sensor				),
	.iv_logic_rdata_2       			(wv_rdata_pix					),
	.iv_logic_rdata_3       			(wv_rdata_fb					),
	.iv_logic_rdata_4       			(wv_rdata_gev					),
	.ov_logic_waddr_0       			(wv_waddr_axi					),
	.ov_logic_waddr_1       			(wv_waddr_sensor				),
	.ov_logic_waddr_2       			(wv_waddr_pix					),
	.ov_logic_waddr_3       			(wv_waddr_fb					),
	.ov_logic_waddr_4       			(wv_waddr_gev					),
	.ov_logic_wdata_0       			(wv_wdata_axi					),
	.ov_logic_wdata_1       			(wv_wdata_sensor				),
	.ov_logic_wdata_2       			(wv_wdata_pix					),
	.ov_logic_wdata_3       			(wv_wdata_fb					),
	.ov_logic_wdata_4       			(wv_wdata_gev					),
	.o_rd_en_0             				(w_rd_en_axi           			),
	.o_rd_en_1             				(w_rd_en_sensor        			),
	.o_rd_en_2             				(w_rd_en_pix					),
	.o_rd_en_3             				(w_rd_en_fb						),
	.o_rd_en_4             				(w_rd_en_gev					),
	.o_rd_valid_0          				(w_rd_valid_axi					),
	.o_rd_valid_1          				(w_rd_valid_sensor				),
	.o_rd_valid_2          				(w_rd_valid_pix					),
	.o_rd_valid_3          				(w_rd_valid_fb					),
	.o_rd_valid_4          				(w_rd_valid_gev					),
	.s00_axi_aclk_1      				(clk_sensor						),
	.s00_axi_aclk_2      				(clk_pix      					),
	.s00_axi_aclk_3      				(clk_frame_buf    				),
	.s00_axi_aclk_4      				(clk_gev						),
	.s00_axi_aresetn_1   				(!reset_sensor		   			),
	.s00_axi_aresetn_2   				(!reset_pix			   			),
	.s00_axi_aresetn_3   				(!reset_frame_buf   			),
	.s00_axi_aresetn_4   				(!reset_gev			   			),
	.spi_io0_io    						(spi_io0_io						),
	.spi_io1_io    						(spi_io1_io						),
	.spi_ss_io     						(spi_ss_io 						),
	.o_wr_en_0             				(w_wr_en_0             			),
	.o_wr_en_1             				(w_wr_en_1             			),
	.o_wr_en_2             				(w_wr_en_2             			),
	.o_wr_en_3             				(w_wr_en_3             			),
	.o_wr_en_4             				(w_wr_en_4             			),
	.o_wr_valid_0          				(w_wr_valid_axi        			),
	.o_wr_valid_1          				(w_wr_valid_sensor				),
	.o_wr_valid_2          				(w_wr_valid_pix					),
	.o_wr_valid_3          				(w_wr_valid_fb					),
	.o_wr_valid_4          				(w_wr_valid_gev					)
	);

	//	-------------------------------------------------------------------------------------
	//	mdio
	//	-------------------------------------------------------------------------------------
	assign	mdio		= mdio_tri ? 1'bz :	mdio_out;
	assign	mdio_in		= mdio;

	//	===============================================================================================
	//	ref ****** data flow ******
	//	===============================================================================================
	//	-------------------------------------------------------------------------------------
	//	sensor_channel
	//	-------------------------------------------------------------------------------------
	sensor_channel_python # (
	.DIFF_TERM						(DIFF_TERM						),
	.SER_FIRST_BIT					(SER_FIRST_BIT					),
	.END_STYLE						(END_STYLE						),
	.SAMPL_CLOCK_ARC				(SAMPL_CLOCK_ARC				),
	.INTER_CLOCK_ARC				(INTER_CLOCK_ARC				),
	.PIXEL_CLOCK_ARC				(PIXEL_CLOCK_ARC				),
	.HIGH_PERFORMANCE_MODE			(HIGH_PERFORMANCE_MODE			),
	.BIT_RATE_VALUE					(BIT_RATE_VALUE					),
	.REF_FREQ						(REF_FREQ						),
	.CHANNEL_NUM					(CHANNEL_NUM					),
	.DESER_WIDTH					(DESER_WIDTH					),
	.CLKIN_PERIOD_NS				(CLKIN_PERIOD_NS				),
	.MMCM_CHECK_CLK_PERIOD_NS		(MMCM_CHECK_CLK_PERIOD_NS		),
	.SIMULATION						(SIMULATION						),
	.KERNEL_LENTH					(KERNEL_LENTH					),
	.SENSOR_DAT_WIDTH				(SENSOR_DAT_WIDTH				),
	.SHORT_REG_WD					(SHORT_REG_WD					),
	.REG_WD							(REG_WD							),
	.INCK_PER_US					(INCK_PER_US					),
	.GIGE_ENABLE					(GIGE_ENABLE					),
	.T2M_TIMEOUT_US					(T2M_TIMEOUT_US					)
	)
	sensor_channel_python_inst (
	.i_clk_p						(i_clk_p						),
	.i_clk_n						(i_clk_n						),
	.iv_data_p						(iv_data_p						),
	.iv_data_n						(iv_data_n						),
	.i_ctrl_p						(i_ctrl_p						),
	.i_ctrl_n						(i_ctrl_n						),
	.clk_ref						(clk_ref						),
	.clk_mmcm_check					(clk_osc_bufg					),
	.i_sensor_init_done				(w_sensor_init_done				),
	.clk_recover					(clk_recover					),
	.reset_recover					(reset_recover					),
	.o_deser_pll_lock				(w_deser_pll_lock				),
	.o_word_align_done				(w_deser_done					),
	.o_clk_en						(w_clk_en_recover				),
	.o_fval							(w_fval_recover					),
	.o_lval							(w_lval_recover					),
	.ov_pix_data					(wv_pix_data_recover			),
	.clk_pix						(clk_pix						),
	.reset_pix						(reset_pix						),
	.iv_python_exposure_time		(wv_python_exposure_time		),
	.iv_python_exposure_delay		(wv_python_exposure_delay		),
	.iv_python_trig_interval		(wv_python_trig_interval		),
	.iv_python_readout_time			(wv_python_readout_time			),
	.i_trigger_mode					(w_trigger_mode					),
	.i_trigger						(w_trigger_n					),
	.i_acquisition_start			(w_acquisition_start_pix		),
	.i_python_exposure_monitor		(iv_monitor[0]					),
	.o_strobe						(w_sensor_strobe				),
	.ov_trigger						(ov_trigger_sensor				),
	.o_full_frame					(w_full_frame_sensor			),
	.o_trigger_mask					(w_trigger_mask					),
	.o_valid_integration			(w_valid_integration			),
	.ov_stop_info					(wv_stop_info					),
	.ov_pad_info					(wv_pad_info					),
	.ov_state_info					(wv_state_info					),
	.o_inter_trig					(								),
	.ov_inter_exposure_time			(								)
	);

	//	-------------------------------------------------------------------------------------
	//	data channel--mainly for ISP
	//	-------------------------------------------------------------------------------------
	data_channel # (
	.SENSOR_DAT_WIDTH				(SENSOR_DAT_WIDTH				),
	.CHANNEL_NUM					(CHANNEL_NUM					),
	.KERNEL_LENTH					(KERNEL_LENTH					),
	.PIX_CLK_FREQ_KHZ				(PIX_CLK_FREQ_KHZ				),
	.U3V_FVAL_TO_DVAL_TIME			(U3V_FVAL_TO_DVAL_TIME			),
	.REG_WD							(REG_WD							),
	.MROI_NUM_MAX					(MROI_NUM_MAX					)
	)
	data_channel_inst (
	.clk_recover					(clk_recover					),
	.reset_recover					(reset_recover					),
	.i_clk_en						(w_clk_en_recover				),
	.i_fval							(w_fval_recover					),
	.i_lval							(w_lval_recover					),
	.iv_pix_data					(wv_pix_data_recover			),
	.clk_pix						(clk_pix						),
	.reset_pix						(reset_pix						),
	.i_full_frame_sensor			(w_full_frame_sensor			),
	.i_acquisition_start			(w_acquisition_start_pix		),
	.i_stream_enable				(w_stream_enable_pix			),
	.i_encrypt_state				(w_encrypt_state				),
	.iv_pixel_format				(wv_pixel_format				),
	.iv_test_image_sel				(wv_test_image_sel				),
	.o_full_frame_state				(w_full_frame_state				),
	.o_fval							(w_fval_data_channel			),
	.o_lval							(w_lval_data_channel			),
	.ov_pix_data					(wv_pix_data_data_channel		),
	.ov_pixel_format				(wv_pixel_format_data_channel	)
	);

	//	-------------------------------------------------------------------------------------
	//	frame info 模块
	//	-------------------------------------------------------------------------------------
	frame_info # (
	.SENSOR_DAT_WIDTH				(SENSOR_DAT_WIDTH				),
	.CHANNEL_NUM					(CHANNEL_NUM					),
	.DATA_WD						(FRAME_BUF_DATA_WD				),
	.STATIS_VALID					(STATIS_VALID					),
	.INFO_WAIT_TIME					(INFO_WAIT_TIME					),
	.IMAGE_WAIT_TIME				(IMAGE_WAIT_TIME				),
	.STATIS_WAIT_TIME				(STATIS_WAIT_TIME				),
	.FVAL_FALL_WAIT_TIME			(FVAL_FALL_WAIT_TIME			),
	.BID_INIT_VALUE					(BID_INIT_VALUE					),
	.INFO_SIZE						(INFO_SIZE						),
	.STATIS_SIZE					(STATIS_SIZE					),
	.MROI_NUM_MAX					(MROI_NUM_MAX					),
	.MROI_OFFSET_WD					(MROI_OFFSET_WD					),
	.MROI_IMAGE_SIZE_WD				(MROI_IMAGE_SIZE_WD				),
	.SHORT_REG_WD					(SHORT_REG_WD					),
	.REG_WD							(REG_WD							),
	.LONG_REG_WD					(LONG_REG_WD					)
	)
	frame_info_inst (
	.clk							(clk_pix						),
	.reset							(reset_pix						),
	.i_fval							(w_fval_data_channel			),
	.i_lval							(w_lval_data_channel			),
	.iv_pix_data					(wv_pix_data_data_channel		),
	.i_stream_enable				(w_stream_enable_pix			),
	.i_mroi_global_en				(w_mroi_global_en				),
	.iv_mroi_single_en				(wv_mroi_single_en				),
	.iv_pixel_format				(wv_pixel_format_data_channel	),
	.iv_timestamp					(wv_timestamp_u3				),
	.iv_frame_interval				(wv_frame_interval				),
	.iv_single_roi_offset_x			(wv_single_roi_offset_x			),
	.iv_single_roi_offset_y			(wv_single_roi_offset_y			),
	.iv_single_roi_width			(wv_single_roi_width			),
	.iv_single_roi_height			(wv_single_roi_height			),
	.iv_single_roi_image_size		(wv_single_roi_image_size		),
	.iv_single_roi_payload_size		(wv_single_roi_payload_size		),
	.i_chunk_mode_active			(w_chunk_mode_active			),
	.i_chunkid_en_img				(w_chunkid_en_img				),
	.i_chunkid_en_fid				(w_chunkid_en_fid				),
	.i_chunkid_en_ts				(w_chunkid_en_ts				),
	.i_chunkid_en_fint				(w_chunkid_en_fint				),
	.iv_expect_payload_size			(wv_expect_payload_size			),
	.o_fval							(w_fval_frame_info				),
	.o_dval							(w_dval_frame_info				),
	.o_info_flag					(w_info_flag_frame_info			),
	.o_image_flag					(w_image_flag_frame_info		),
	.o_statis_flag					(w_statis_flag_frame_info		),
	.ov_data						(wv_data_frame_info				)
	);

	//	-------------------------------------------------------------------------------------
	//	帧存模块
	//	-------------------------------------------------------------------------------------
	frame_buffer # (
	.BID_WD							(BID_WD							),
	.PID_WD							(PID_WD							),
	.DATA_WD						(FRAME_BUF_DATA_WD				),
	.IMAGE_SIZE_WD					(IMAGE_SIZE_WD					),
	.MEM_SIZE_MBIT					(MEM_SIZE_MBIT					),
	.SHORT_REG_WD					(SHORT_REG_WD					),
	.REG_WD							(REG_WD							),
	.LONG_REG_WD					(LONG_REG_WD					),
	.GEV_DATA_WD					(GEV_DATA_WD					),
	.GEV_DE_WD						(GEV_DE_WD						),
	.FRAME_DEPTH_MAX				(FRAME_DEPTH_MAX				),
	.MEM_DQ_WD						(MEM_DQ_WD						),
	.MEM_ADDR_WD					(MEM_ADDR_WD					),
	.MEM_BANKADDR_WD				(MEM_BANKADDR_WD				),
	.MEM_DM_WD						(MEM_DM_WD						),
	.MEM_DQS_WD						(MEM_DQS_WD						),
	.PKT_LENGTH_WD					(PKT_LENGTH_WD					),
	.PKT_CNT_WD						(PKT_CNT_WD						)
	)
	frame_buffer_inst (
	.clk_in							(clk_pix						),
	.i_fval							(w_fval_frame_info				),
	.i_dval							(w_dval_frame_info				),
	.i_info_flag					(w_info_flag_frame_info			),
	.i_image_flag					(w_image_flag_frame_info		),
	.i_statis_flag					(w_statis_flag_frame_info		),
	.iv_data						(wv_data_frame_info				),
	.iv_image_size					(wv_image_size_frame_buf		),
	.o_fb_fifo_overflow				(w_fb_fifo_overflow				),
	.clk_gev						(clk_gev						),
	.reset_gev						(reset_gev						),
	.iv_resend_block_id				(wv_resend_block_id				),
	.iv_resend_packet_id_first		(wv_resend_packet_id_first		),
	.iv_resend_packet_id_last		(wv_resend_packet_id_last		),
	.i_resend_en					(w_resend_en					),
	.i_fb_rd						(w_fb_rd						),
	.o_fb_empty						(w_fb_empty						),
	.ov_data_is_cmd					(wv_data_is_cmd_frame_buf		),
	.ov_dval						(wv_dval_frame_buf				),
	.ov_data						(wv_data_frame_buf				),
	.i_stream_enable				(w_stream_enable_frame_buf		),
	.i_fb_transfer_start			(w_fb_transfer_start_frame_buf	),
	.iv_frame_depth					(wv_frame_depth					),
	.i_fb_overwrite					(w_fb_overwrite					),
	.iv_pkt_length					(wv_pkt_length_frame_buf		),
	.iv_remain_pkt_length			(wv_remain_pkt_length_frame_buf	),
	.iv_pic_pkt_cnt					(wv_pkt_cnt_frame_buf			),
	.i_mroi_global_en				(w_mroi_global_en_frame_buf		),
	.iv_mroi_num_en					(wv_mroi_num_en_frame_buf		),
	.ov_mroi_num_resend				(wv_mroi_num_resend_frame_buf	),
	.o_frame_cover_event			(w_frame_cover_event			),
	.o_frame_not_empty_event		(w_frame_not_empty_event		),
	.clk_mig						(clk_mig						),
	.reset_mig						(reset_mig						),
	.clk_ref						(clk_ref						),
	.o_calib_done					(w_calib_done					),
	.ddr3_dq						(ddr3_dq						),
	.ddr3_addr						(ddr3_addr						),
	.ddr3_ba						(ddr3_ba						),
	.ddr3_ras_n						(ddr3_ras_n						),
	.ddr3_cas_n						(ddr3_cas_n						),
	.ddr3_we_n						(ddr3_we_n						),
	.ddr3_odt						(ddr3_odt						),
	.ddr3_reset_n					(ddr3_reset_n					),
	.ddr3_cke						(ddr3_cke						),
	.ddr3_dm						(ddr3_dm						),
	.ddr3_dqs_p						(ddr3_dqs_p						),
	.ddr3_dqs_n						(ddr3_dqs_n						),
	.ddr3_ck_p						(ddr3_ck_p						),
	.ddr3_ck_n						(ddr3_ck_n						)
	);


	//	-------------------------------------------------------------------------------------
	//	gige vision 处理模块
	//	-------------------------------------------------------------------------------------
	gige_vision # (
	.SHORT_REG_WD						(SHORT_REG_WD						),
	.REG_WD								(REG_WD								),
	.LONG_REG_WD						(LONG_REG_WD						),
	.GEV_DATA_WD						(GEV_DATA_WD						),
	.GEV_DE_WD							(GEV_DE_WD							),
	.GEV_BE_WD							(GEV_BE_WD							),
	.MAC_DATA_WD						(MAC_DATA_WD						),
	.MAC_BE_WD							(MAC_BE_WD							),
	.PB_RD_CNT_WD						(PB_RD_CNT_WD						),
	.PKT_LENGTH_WD						(PKT_LENGTH_WD						),
	.PKT_CNT_WD							(PKT_CNT_WD							),
	.INFO_SIZE							(INFO_SIZE							),
	.STATIS_SIZE						(STATIS_SIZE						),
	.AXI_DATA_WD						(AXI_DATA_WD						),
	.AXI_ADDR_WD						(AXI_ADDR_WD						)
	)
	gige_vision_inst (
	.clk_gev							(clk_gev							),
	.reset_gev							(reset_gev							),
	.clk_gtx							(clk_gtx							),
	.reset_gtx							(reset_gtx							),
	.clk_axi							(clk_axi							),
	.reset_axi							(reset_microb						),	//不确定 此处用rset_microb是否合适
	.clk_grx							(clk_gtx							),	//clk_grx clk_gtx 是同一个时钟
	.reset_grx							(reset_gtx							),	//
	.i_stream_enable_gev				(w_stream_enable_gev				),
	.i_stream_enable_gtx				(w_stream_enable_gtx				),
	.i_ge_transfer_start				(w_ge_transfer_start_gev			),
	.o_fb_rd							(w_fb_rd							),
	.i_fb_empty							(w_fb_empty							),
	.iv_data_is_cmd						(wv_data_is_cmd_frame_buf			),
	.iv_dval							(wv_dval_frame_buf					),
	.iv_data							(wv_data_frame_buf					),
	.i_test_pkt_enable_gev				(w_test_pkt_enable_gev				),
	.o_test_pkt_over_gev				(w_test_pkt_over_gev				),
	.iv_pc_ip_gev						(wv_pc_ip_gev						),
	.iv_camera_ip_gev					(wv_camera_ip_gev					),
	.iv_pc_port_sc_gev					(wv_pc_port_sc_gev					),
	.iv_camera_port_gev					(wv_camera_port_gev					),
	.iv_pkt_length_gev					(wv_pkt_length_gev					),
	.iv_pkt_cnt_gev						(wv_pkt_cnt_gev						),
	.iv_remain_pkt_length_gev			(wv_remain_pkt_length_gev			),
	.iv_gvcp_length_gtx					(wv_gvcp_length_gtx					),
	.iv_pc_mac_gtx						(wv_pc_mac_gtx						),
	.iv_camera_mac_gtx					(wv_camera_mac_gtx					),
	.iv_packet_gap_gtx					(wv_packet_gap_gtx					),
	.i_gvcp_ack_txen_gtx				(w_gvcp_ack_txen_gtx				),
	.o_gvcp_ack_tx_start_gtx			(w_gvcp_ack_tx_start_gtx			),
	.iv_camera_ip_gtx					(wv_camera_ip_gtx					),
	.iv_pc_ip_gtx						(wv_pc_ip_gtx						),
	.iv_ip_mask_gtx						(wv_ip_mask_gtx						),
	.iv_pc_port_cc_gtx					(wv_pc_port_cc_gtx					),
	.iv_pc_port_mc_gtx					(wv_pc_port_mc_gtx					),
	.iv_irq_status_gtx					(wv_irq_status_gtx					),
	.o_mac_valid_gtx					(w_mac_valid_gtx					),
	.o_protocal_match_gtx				(w_protocal_match_gtx				),
	.o_heartbeat_clr_gtx				(w_heartbeat_clr_gtx				),
	.ov_resend_block_id_gtx				(wv_resend_block_id_gtx				),
	.ov_resend_packet_id_first_gtx		(wv_resend_packet_id_first_gtx		),
	.ov_resend_packet_id_last_gtx		(wv_resend_packet_id_last_gtx		),
	.o_resend_en_gtx					(w_resend_en_gtx					),
	.iv_axi_addr						(wv_axi_addr						),
	.iv_axi_be							(wv_axi_be							),
	.i_axi_wr_en						(w_axi_wr_en						),
	.iv_axi_wr_data						(wv_axi_wr_data						),
	.ov_axi_rd_data						(wv_axi_rd_data						),

	.ov_tx_ifg_delay					(wv_tx_ifg_delay					),
	.o_tx_axis_aresetn					(w_tx_axis_aresetn					),
	.ov_tx_axis_tdata					(wv_tx_axis_tdata					),
	.ov_tx_axis_tkeep					(wv_tx_axis_tkeep					),
	.o_tx_axis_tvalid					(w_tx_axis_tvalid					),
	.o_tx_axis_tlast					(w_tx_axis_tlast					),
	.o_tx_axis_tuser					(w_tx_axis_tuser					),
	.i_tx_axis_tready					(w_tx_axis_tready					),

	.iv_rx_axis_tdata					(wv_rx_axis_tdata					),
	.iv_rx_axis_tkeep					(wv_rx_axis_tkeep					),
	.i_rx_axis_tvalid					(w_rx_axis_tvalid					),
	.i_rx_axis_tlast					(w_rx_axis_tlast					),
	.i_rx_axis_tuser					(w_rx_axis_tuser					)

	);

	//	-------------------------------------------------------------------------------------
	//	ten_gig_eth_mac
	//	-------------------------------------------------------------------------------------
	ten_gig_eth_mac_0_support ten_gig_eth_mac_inst (
	.tx_clk0						(clk_gtx					),
	.reset							(reset_gtx					),
	.tx_axis_aresetn				(w_tx_axis_aresetn			),
	.tx_axis_tdata					(wv_tx_axis_tdata			),
	.tx_axis_tvalid					(w_tx_axis_tvalid			),
	.tx_axis_tlast					(w_tx_axis_tlast			),
	.tx_axis_tuser					(w_tx_axis_tuser			),
	.tx_ifg_delay					(wv_tx_ifg_delay			),
	.tx_axis_tkeep					(wv_tx_axis_tkeep			),
	.tx_axis_tready					(w_tx_axis_tready			),
	.tx_statistics_vector			(							),
	.tx_statistics_valid			(							),

	.pause_val						(0							),
	.pause_req						(0							),

	.rx_axis_aresetn				(w_tx_axis_aresetn			),	//此处用w_tx_axis_aresetn是否合适
	.rx_axis_tdata					(wv_rx_axis_tdata			),
	.rx_axis_tkeep					(wv_rx_axis_tkeep			),
	.rx_axis_tvalid					(w_rx_axis_tvalid			),
	.rx_axis_tuser					(w_rx_axis_tuser			),
	.rx_axis_tlast					(w_rx_axis_tlast			),
	.rx_statistics_vector			(							),
	.rx_statistics_valid			(							),

	.s_axi_aclk             		(clk_axi					),
	.s_axi_aresetn          		(1'b1						),
	.s_axi_awaddr           		(m_axi_if_awaddr[10:0]		),
	.s_axi_awvalid          		(m_axi_if_awvalid    		),
	.s_axi_awready          		(m_axi_if_awready    		),
	.s_axi_wdata            		(m_axi_if_wdata[31:0] 		),
	.s_axi_wvalid           		(m_axi_if_wvalid     		),
	.s_axi_wready           		(m_axi_if_wready     		),
	.s_axi_bresp            		(m_axi_if_bresp[1:0]  		),
	.s_axi_bvalid           		(m_axi_if_bvalid     		),
	.s_axi_bready           		(m_axi_if_bready     		),
	.s_axi_araddr           		(m_axi_if_araddr[10:0]		),
	.s_axi_arvalid          		(m_axi_if_arvalid    		),
	.s_axi_arready          		(m_axi_if_arready    		),
	.s_axi_rdata            		(m_axi_if_rdata      		),
	.s_axi_rresp            		(m_axi_if_rresp[1:0]		),
	.s_axi_rvalid           		(m_axi_if_rvalid			),
	.s_axi_rready           		(m_axi_if_rready			),
	.xgmacint               		(							),
	.mdc                    		(mdc						),
	.mdio_in                		(mdio_in					),
	.mdio_out               		(mdio_out					),
	.mdio_tri               		(mdio_tri					),
	.tx_dcm_locked          		(w_rxaui_locked				),
	.xgmii_txd              		(xgmii_txd					),
	.xgmii_txc              		(xgmii_txc					),
	.rx_clk0                		(w_rxaui_locked				),
	.rx_dcm_locked          		(w_rxaui_locked				),
	.xgmii_rxd              		(xgmii_rxd					),
	.xgmii_rxc              		(xgmii_rxc					)
	);

	//	-------------------------------------------------------------------------------------
	//	rxaui
	//	-------------------------------------------------------------------------------------
	rxaui_0 rxaui_inst (
	.reset							(1'b0						),
	.dclk							(clk_microb					),
	.clk156_out						(clk_gtx					), // Output clock than can be used for external logic
	.clk156_lock					(w_rxaui_locked				),
	.pll0outclk_out					(							),
	.pll0lock_out					(							),
	.pll0outrefclk_out				(							),
	.pll1outclk_out					(							),
	.pll1outrefclk_out				(							),
	.common_pll_reset_out			(							),
	.refclk_p						(refclk_p					),
	.refclk_n						(refclk_n					),
	.xgmii_txd						(xgmii_txd					),
	.xgmii_txc						(xgmii_txc					),
	.xgmii_rxd						(xgmii_rxd					),
	.xgmii_rxc						(xgmii_rxc					),
	.rxaui_tx_l0_p					(rxaui_tx_l0_p				),
	.rxaui_tx_l0_n					(rxaui_tx_l0_n				),
	.rxaui_tx_l1_p					(rxaui_tx_l1_p				),
	.rxaui_tx_l1_n					(rxaui_tx_l1_n				),
	.rxaui_rx_l0_p					(rxaui_rx_l0_p				),
	.rxaui_rx_l0_n					(rxaui_rx_l0_n				),
	.rxaui_rx_l1_p					(rxaui_rx_l1_p				),
	.rxaui_rx_l1_n					(rxaui_rx_l1_n				),
	.signal_detect					(2'b11						),
	.debug							(							),
	.configuration_vector			(7'h00						),
	.status_vector					(							)
	);

endmodule
